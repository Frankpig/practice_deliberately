{"ast":null,"code":"var _jsxFileName = \"/Users/handsomeboy/Documents/playplay/10k_hours/10k_hours_app/src/components/SkillProgress.js\",\n  _s = $RefreshSig$();\nimport React, { useEffect, useRef, useState } from 'react';\nimport { Chart, registerables } from 'chart.js';\nimport './SkillProgress.css';\n\n// 注册所有必要的组件\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nChart.register(...registerables);\nconst SkillProgress = () => {\n  _s();\n  const pieChartRef = useRef(null);\n  const barChartRef = useRef(null);\n  const pieChartInstance = useRef(null);\n  const barChartInstance = useRef(null);\n  const [refReady, setRefReady] = useState(false);\n\n  // 使用模拟数据\n  const skills = [{\n    id: '1',\n    name: '编程',\n    hoursPracticed: 500,\n    targetHours: 10000\n  }, {\n    id: '2',\n    name: '英语',\n    hoursPracticed: 1000,\n    targetHours: 10000\n  }, {\n    id: '3',\n    name: '吉他',\n    hoursPracticed: 200,\n    targetHours: 10000\n  }];\n  console.log('使用模拟数据:', skills);\n\n  // 销毁旧图表实例\n  const destroyCharts = () => {\n    if (pieChartInstance.current) {\n      pieChartInstance.current.destroy();\n      pieChartInstance.current = null;\n    }\n    if (barChartInstance.current) {\n      barChartInstance.current.destroy();\n      barChartInstance.current = null;\n    }\n  };\n\n  // 检测ref是否已准备好\n  useEffect(() => {\n    const checkRefs = () => {\n      if (pieChartRef.current && barChartRef.current) {\n        console.log('图表ref已准备就绪');\n        setRefReady(true);\n      } else {\n        // 如果ref尚未准备好，100ms后再次检查\n        setTimeout(checkRefs, 100);\n      }\n    };\n    checkRefs();\n  }, []);\n\n  // 创建或更新图表\n  useEffect(() => {\n    // 如果ref尚未准备好，不创建图表\n    if (!refReady) {\n      console.log('ref尚未准备好，推迟创建图表');\n      return;\n    }\n\n    // 销毁旧图表\n    destroyCharts();\n    if (skills.length === 0) {\n      console.log('没有技能数据，不创建图表');\n      return;\n    }\n    console.log('开始创建图表...');\n\n    // 创建饼图数据\n    const pieData = {\n      labels: skills.map(skill => skill.name),\n      datasets: [{\n        data: skills.map(skill => skill.hoursPracticed),\n        backgroundColor: ['#61dafb', '#21a1f1', '#7b1fa2', '#e1bee7', '#388e3c', '#c8e6c9', '#ff6f00', '#ffecb3'],\n        borderWidth: 1\n      }]\n    };\n    console.log('饼图数据:', pieData);\n\n    // 创建饼图\n    try {\n      pieChartInstance.current = new Chart(pieChartRef.current, {\n        type: 'pie',\n        data: pieData,\n        options: {\n          responsive: true,\n          plugins: {\n            legend: {\n              position: 'right'\n            },\n            title: {\n              display: true,\n              text: '技能练习时间分布'\n            }\n          }\n        }\n      });\n      console.log('饼图创建成功');\n    } catch (error) {\n      console.error('创建饼图时出错:', error);\n    }\n\n    // 创建柱状图数据\n    const barData = {\n      labels: skills.map(skill => skill.name),\n      datasets: [{\n        label: '已练习小时数',\n        data: skills.map(skill => skill.hoursPracticed),\n        backgroundColor: '#61dafb',\n        borderWidth: 1\n      }, {\n        label: '目标小时数',\n        data: skills.map(skill => skill.targetHours),\n        backgroundColor: '#e0e0e0',\n        borderWidth: 1\n      }]\n    };\n    console.log('柱状图数据:', barData);\n\n    // 创建柱状图\n    try {\n      barChartInstance.current = new Chart(barChartRef.current, {\n        type: 'bar',\n        data: barData,\n        options: {\n          responsive: true,\n          scales: {\n            y: {\n              beginAtZero: true,\n              title: {\n                display: true,\n                text: '小时数'\n              }\n            },\n            x: {\n              title: {\n                display: true,\n                text: '技能'\n              }\n            }\n          },\n          plugins: {\n            title: {\n              display: true,\n              text: '技能进度对比'\n            }\n          }\n        }\n      });\n      console.log('柱状图创建成功');\n    } catch (error) {\n      console.error('创建柱状图时出错:', error);\n    }\n\n    // 组件卸载时销毁图表\n    return () => destroyCharts();\n  }, [refReady]);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"skill-progress\",\n    children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n      children: \"\\u6280\\u80FD\\u8FDB\\u5EA6\\u56FE\\u8868\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 166,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"charts-container\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"chart-item\",\n        children: /*#__PURE__*/_jsxDEV(\"canvas\", {\n          ref: pieChartRef,\n          width: \"400\",\n          height: \"300\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 169,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 168,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"chart-item\",\n        children: /*#__PURE__*/_jsxDEV(\"canvas\", {\n          ref: barChartRef,\n          width: \"400\",\n          height: \"300\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 172,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 171,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 167,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 165,\n    columnNumber: 5\n  }, this);\n};\n_s(SkillProgress, \"e7KVivdMIZyUzn3ju22ZQoP2dFY=\");\n_c = SkillProgress;\nexport default SkillProgress;\nvar _c;\n$RefreshReg$(_c, \"SkillProgress\");","map":{"version":3,"names":["React","useEffect","useRef","useState","Chart","registerables","jsxDEV","_jsxDEV","register","SkillProgress","_s","pieChartRef","barChartRef","pieChartInstance","barChartInstance","refReady","setRefReady","skills","id","name","hoursPracticed","targetHours","console","log","destroyCharts","current","destroy","checkRefs","setTimeout","length","pieData","labels","map","skill","datasets","data","backgroundColor","borderWidth","type","options","responsive","plugins","legend","position","title","display","text","error","barData","label","scales","y","beginAtZero","x","className","children","fileName","_jsxFileName","lineNumber","columnNumber","ref","width","height","_c","$RefreshReg$"],"sources":["/Users/handsomeboy/Documents/playplay/10k_hours/10k_hours_app/src/components/SkillProgress.js"],"sourcesContent":["import React, { useEffect, useRef, useState } from 'react';\nimport { Chart, registerables } from 'chart.js';\nimport './SkillProgress.css';\n\n// 注册所有必要的组件\nChart.register(...registerables);\n\nconst SkillProgress = () => {\n  const pieChartRef = useRef(null);\n  const barChartRef = useRef(null);\n  const pieChartInstance = useRef(null);\n  const barChartInstance = useRef(null);\n  const [refReady, setRefReady] = useState(false);\n\n  // 使用模拟数据\n  const skills = [\n    { id: '1', name: '编程', hoursPracticed: 500, targetHours: 10000 },\n    { id: '2', name: '英语', hoursPracticed: 1000, targetHours: 10000 },\n    { id: '3', name: '吉他', hoursPracticed: 200, targetHours: 10000 }\n  ];\n\n  console.log('使用模拟数据:', skills);\n\n  // 销毁旧图表实例\n  const destroyCharts = () => {\n    if (pieChartInstance.current) {\n      pieChartInstance.current.destroy();\n      pieChartInstance.current = null;\n    }\n    if (barChartInstance.current) {\n      barChartInstance.current.destroy();\n      barChartInstance.current = null;\n    }\n  };\n\n  // 检测ref是否已准备好\n  useEffect(() => {\n    const checkRefs = () => {\n      if (pieChartRef.current && barChartRef.current) {\n        console.log('图表ref已准备就绪');\n        setRefReady(true);\n      } else {\n        // 如果ref尚未准备好，100ms后再次检查\n        setTimeout(checkRefs, 100);\n      }\n    };\n\n    checkRefs();\n  }, []);\n\n  // 创建或更新图表\n  useEffect(() => {\n    // 如果ref尚未准备好，不创建图表\n    if (!refReady) {\n      console.log('ref尚未准备好，推迟创建图表');\n      return;\n    }\n\n    // 销毁旧图表\n    destroyCharts();\n\n    if (skills.length === 0) {\n      console.log('没有技能数据，不创建图表');\n      return;\n    }\n\n    console.log('开始创建图表...');\n\n    // 创建饼图数据\n    const pieData = {\n      labels: skills.map(skill => skill.name),\n      datasets: [{\n        data: skills.map(skill => skill.hoursPracticed),\n        backgroundColor: [\n          '#61dafb', '#21a1f1', '#7b1fa2', '#e1bee7',\n          '#388e3c', '#c8e6c9', '#ff6f00', '#ffecb3'\n        ],\n        borderWidth: 1\n      }]\n    };\n\n    console.log('饼图数据:', pieData);\n\n    // 创建饼图\n    try {\n      pieChartInstance.current = new Chart(pieChartRef.current, {\n        type: 'pie',\n        data: pieData,\n        options: {\n          responsive: true,\n          plugins: {\n            legend: {\n              position: 'right',\n            },\n            title: {\n              display: true,\n              text: '技能练习时间分布'\n            }\n          }\n        }\n      });\n      console.log('饼图创建成功');\n    } catch (error) {\n      console.error('创建饼图时出错:', error);\n    }\n\n    // 创建柱状图数据\n    const barData = {\n      labels: skills.map(skill => skill.name),\n      datasets: [{\n        label: '已练习小时数',\n        data: skills.map(skill => skill.hoursPracticed),\n        backgroundColor: '#61dafb',\n        borderWidth: 1\n      }, {\n        label: '目标小时数',\n        data: skills.map(skill => skill.targetHours),\n        backgroundColor: '#e0e0e0',\n        borderWidth: 1\n      }]\n    };\n\n    console.log('柱状图数据:', barData);\n\n    // 创建柱状图\n    try {\n      barChartInstance.current = new Chart(barChartRef.current, {\n        type: 'bar',\n        data: barData,\n        options: {\n          responsive: true,\n          scales: {\n            y: {\n              beginAtZero: true,\n              title: {\n                display: true,\n                text: '小时数'\n              }\n            },\n            x: {\n              title: {\n                display: true,\n                text: '技能'\n              }\n            }\n          },\n          plugins: {\n            title: {\n              display: true,\n              text: '技能进度对比'\n            }\n          }\n        }\n      });\n      console.log('柱状图创建成功');\n    } catch (error) {\n      console.error('创建柱状图时出错:', error);\n    }\n\n    // 组件卸载时销毁图表\n    return () => destroyCharts();\n  }, [refReady]);\n\n  return (\n    <div className=\"skill-progress\">\n      <h2>技能进度图表</h2>\n      <div className=\"charts-container\">\n        <div className=\"chart-item\">\n          <canvas ref={pieChartRef} width=\"400\" height=\"300\"></canvas>\n        </div>\n        <div className=\"chart-item\">\n          <canvas ref={barChartRef} width=\"400\" height=\"300\"></canvas>\n        </div>\n      </div>\n    </div>\n  );\n};\n\nexport default SkillProgress;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}
<!-- recordPractice.wxml - é‡æ–°è®¾è®¡ -->
<view class="container {{darkModeClass}}" style="background-color: var(--background-color); min-height: 100vh; padding: 30rpx; transition: all 0.3s ease;">
  <!-- é¡µé¢æ ‡é¢˜ -->
  <view class="header">
    <h1 style="color: var(--text-primary); font-weight: 600; margin-bottom: 10rpx;">è®°å½•ç»ƒä¹ æ—¶é—´</h1>
    <p style="color: var(--text-secondary); font-size: 26rpx; margin-top: 0;">{{greeting}}, è®°å½•ä»Šæ—¥çš„è¿›æ­¥</p>
  </view>

  <view style="height: 40rpx;"></view> <!-- å¢åŠ è¡Œé—´è· -->

  <!-- ç©ºçŠ¶æ€ -->
  <view wx:if="{{skills.length === 0}}" class="empty-state">
    <view class="empty-icon">ğŸ“</view>
    <p class="empty-text">æš‚æ— æŠ€èƒ½</p>
    <button type="primary" bindtap="navigateToAddSkill" style="margin-top: 20rpx; background-color: var(--accent-color); color: white;">æ·»åŠ æŠ€èƒ½</button>
  </view>

  <block wx:else>
    <!-- ä¸»è¦è¡¨å•å¡ç‰‡ -->
    <view class="form-card">
      <!-- æŠ€èƒ½é€‰æ‹©åŒºåŸŸ -->
      <view class="form-section">
        <label class="section-label">é€‰æ‹©æŠ€èƒ½</label>
        <view class="skill-selection">
          <!-- å¸¸ç”¨æŠ€èƒ½å¿«é€Ÿé€‰æ‹© -->
          <view class="recent-skills" wx:if="{{recentSkills.length > 0}}">
            <scroll-view scroll-x="true" enable-flex class="skills-scroll">
              <view wx:for="{{recentSkills}}" wx:key="id" class="skill-chip {{selectedSkillId === item.id ? 'selected' : ''}}" bindtap="selectSkillQuickly" data-skill-id="{{item.id}}" data-skill-index="{{item.index}}">
                <text>{{item.name}}</text>
              </view>
            </scroll-view>
          </view>
          
          <!-- å®Œæ•´æŠ€èƒ½é€‰æ‹©å™¨ -->
          <picker bindchange="onSkillSelect" value="{{selectedSkillIndex}}" range="{{skills}}" range-key="name" style="width: 100%;" picker-class="large-picker">
            <view class="skill-picker">
              <text class="picker-text">{{selectedSkillName}}</text>
              <text class="arrow-icon">â–¼</text>
            </view>
          </picker>
        </view>
      </view>

      <!-- æ—¶é—´é€‰æ‹©åŒºåŸŸ - æ»‘åŠ¨é€‰æ‹©å™¨æ ·å¼ -->
      <view class="form-section">
        <label class="section-label">ç»ƒä¹ æ—¶é—´</label>
        <view class="time-selection">
          <!-- æ—¶é—´é€‰æ‹©å¡ç‰‡ -->
          <view class="time-picker-card">
            <view class="time-display">
              <text class="time-hours">{{selectedHours}}</text>
              <text class="time-separator">:</text>
              <text class="time-minutes">{{selectedMinutes < 10 ? '0' + selectedMinutes : selectedMinutes}}</text>
            </view>
            
            <!-- æ—¶é—´æ»‘å— -->
            <view class="time-slider-container">
              <slider min="0" max="12" step="1" value="{{selectedHours}}" activeColor="var(--accent-color)" backgroundColor="var(--progress-bg)" block-size="36rpx" block-color="var(--accent-color)" bindchange="onHoursSliderChange" />
              <view class="slider-labels">
                <text>0å°æ—¶</text>
                <text>12å°æ—¶</text>
              </view>
            </view>
            
            <!-- åˆ†é’Ÿé€‰æ‹© -->
            <view class="minutes-options">
              <view class="minute-option {{selectedMinutes === 0 ? 'selected' : ''}}" bindtap="selectMinutes" data-minutes="0">0åˆ†</view>
              <view class="minute-option {{selectedMinutes === 15 ? 'selected' : ''}}" bindtap="selectMinutes" data-minutes="15">15åˆ†</view>
              <view class="minute-option {{selectedMinutes === 30 ? 'selected' : ''}}" bindtap="selectMinutes" data-minutes="30">30åˆ†</view>
              <view class="minute-option {{selectedMinutes === 45 ? 'selected' : ''}}" bindtap="selectMinutes" data-minutes="45">45åˆ†</view>
            </view>
          </view>
        </view>
      </view>

      <!-- ç»ƒä¹ ç¬”è®°åŒºåŸŸ -->
      <view class="form-section">
        <label class="section-label">ç»ƒä¹ ç¬”è®° (å¯é€‰)</label>
        <textarea placeholder="è®°å½•ä»Šå¤©çš„ç»ƒä¹ æ„Ÿå—å’Œæ”¶è·..." placeholder-style="color: var(--text-tertiary);" value="{{practiceNotes}}" bindinput="onNotesInput" class="notes-input" maxlength="200" auto-height show-confirm-bar="false"></textarea>
      </view>

      <!-- æ“ä½œæŒ‰é’® -->
      <button type="default" bindtap="handleSubmit" class="submit-btn" hover-class="button-hover">
        è®°å½•ç»ƒä¹ 
      </button>
    </view>

    <!-- æœ€è¿‘ç»ƒä¹ è®°å½• -->
    <view class="recent-activities" wx:if="{{recentActivities.length > 0}}">
      <h3 class="section-title">æœ€è¿‘è®°å½•</h3>
      <view class="activities-list">
        <view wx:for="{{recentActivities}}" wx:key="index" class="activity-item">
          <view class="activity-info">
            <text class="activity-skill">{{item.skillName}}</text>
            <text class="activity-time">{{item.hours}}å°æ—¶{{item.minutes}}åˆ†é’Ÿ</text>
          </view>
          <text class="activity-date">{{item.date}}</text>
        </view>
      </view>
    </view>

    <!-- æç¤ºä¿¡æ¯ -->
    <view class="tip-container">
      <text class="tip-icon">ğŸ’¡</text>
      <text class="tip-text">{{motivationalTip}}</text>
    </view>
  </block>
</view>